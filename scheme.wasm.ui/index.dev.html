<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    <%= htmlWebpackPlugin.options.title %>
  </title>
  <script>
    window.addEventListener('error', event => {
      const app = document.getElementById('app');
      const head = document.createElement('h2');
      const details = document.createElement('div');
      if (event.message.toLowerCase().indexOf('script error') >= 0) {
        head.append('Script Error');
        details.append('See console for details');
      } else {
        head.append('Uncaught Error');
        const message = [
          'Message: ' + event.message,
          'Url: ' + event.filename,
          'Line: ' + event.lineno + ', column: ' + event.colno,
          'Error: ' + event.error
        ];
        message.forEach(el => {
          details.append(el);
          details.append(document.createElement('br'));
        });
      }
      app.append(head);
      app.append(details);
      return false;
    });
  </script>
</head>

<body>
  <div id="app"></div>
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs/loader.min.js"></script>
  <script>
    require.config({ paths: { vs: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs/" } });
    window.MonacoEnvironment = {
      getWorkerUrl: function (moduleId, label) {
        return `data:text/javascript;charset=utf-8,${encodeURIComponent(`
          self.MonacoEnvironment = { baseUrl: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/"};
          importScripts("https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs/base/worker/workerMain.min.js");`
        )}`;
      }
    };

    function getMonaco() {
      return new Promise((resolve, reject) => {
        require(["vs/editor/editor.main"], function (monaco) {
          window.monaco = monaco;
          console.log("Loaded editor.main");
          resolve();
        }, reject);
      });
    }
  </script>
</body>

</html>